<div class="container mat-elevation-z2">
  <h2 class="title">Gerenciamento de Clientes</h2>
  <button class="btn btn-primary" (click)="abrirDialogCadastro()">Adicionar Novo Cliente</button> <br><br>
  <div class="filtro btn-group">
    <button class="btn" [ngClass]="filtroAtual === 'ativos' ? 'btn-selected' : ''"
      (click)="filtrarClientes('ativos')">Ativos</button>
    <button class="btn" [ngClass]="filtroAtual === 'inativos' ? 'btn-selected' : ''"
      (click)="filtrarClientes('inativos')">Inativos</button>
    <button class="btn" [ngClass]="filtroAtual === 'todos' ? 'btn-selected' : ''"
      (click)="filtrarClientes('todos')">Todos</button>
  </div>
  <div class="pesquisa mb-3">
    <input type="text" class="form-control" [(ngModel)]="termoBusca" placeholder="Buscar por nome"
      (input)="filtrarClientesPorNome()">
    <button class="btn btn-secondary" (click)="limparBusca()">Limpar</button>
  </div>
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th>#</th>
        <th>Nome</th>
        <th>Tipo</th>
        <th>Telefone</th>
        <th>Documento</th>
        <th>RG ou IE</th>
        <th>Data de Cadastro</th>
        <th>Ativo</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of clientes; index as i">
        <td>{{ i + 1 }}</td>
        <td>{{ c.nome }}</td>
        <td>{{ c.tipo }}</td>
        <td>
          <ul class="list-unstyled">
            <li *ngFor="let telefone of c.telefones; let idx = index">
              {{ telefone | mask: '(00) 0000-0000' }}
              <button class="btn btn-danger btn-sm" (click)="removerTelefone(c, idx)">Remover</button>
            </li>
          </ul>
          <div class="input-group">
            <input type="text" class="form-control" [(ngModel)]="c.novoTelefone" placeholder="Novo Telefone"
              mask="(00) 0000-0000">
            <div class="input-group-append">
              <button class="btn btn-primary" (click)="adicionarTelefone(c)">Adicionar</button>
            </div>
          </div>
        </td>
        <td>{{ c.tipo === 'Pessoa Jurídica' ? (c.documento | mask:'00.000.000/0000-00') : (c.documento |
          mask:'000.000.000-00') }}</td>
        <td>{{ c.rgOuIe }}</td>
        <td>{{ c.dataCadastro | date:'dd/MM/yyyy' }}</td>
        <td>
          <button class="btn" [ngClass]="{'btn-success': c.ativo, 'btn-danger': !c.ativo}"
            (click)="alternarAtivoCliente(c)">{{ c.ativo ? 'Ativo' : 'Inativo' }}</button>
        </td>
        <td>
          <button class="btn btn-success" (click)="abrirDialogEditar(i)">Editar</button>
          <button class="btn btn-danger" (click)="removerCliente(c)">Excluir</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
